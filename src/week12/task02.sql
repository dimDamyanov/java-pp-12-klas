-- Task 02
SELECT mountains.mountain_range, peaks.peak_name, peaks.elevation FROM mountains INNER JOIN mountains_countries ON mountains.id = mountains_countries.mountain_id INNER JOIN peaks ON mountains_countries.mountain_id = peaks.mountain_id WHERE mountains_countries.country_code = (SELECT countries.country_code FROM countries WHERE countries.country_name = 'Bulgaria') AND peaks.elevation = (SELECT MAX(peaks.elevation) FROM peaks WHERE peaks.mountain_id = mountains_countries.mountain_id) ORDER BY peaks.elevation DESC;
SELECT mountains.mountain_range FROM mountains INNER JOIN mountains_countries ON mountains.id = mountains_countries.mountain_id WHERE mountains_countries.country_code = (SELECT countries.country_code FROM countries WHERE countries.country_name = 'Bulgaria') AND NOT EXISTS (SELECT * FROM peaks WHERE peaks.mountain_id = mountains.id);
SELECT mountains.mountain_range, NVL(peaks.peak_name, 'no info'), NVL(peaks.elevation, 0) FROM mountains INNER JOIN mountains_countries ON mountains.id = mountains_countries.mountain_id LEFT JOIN peaks ON mountains_countries.mountain_id = peaks.mountain_id WHERE mountains_countries.country_code = (SELECT countries.country_code FROM countries WHERE countries.country_name = 'Bulgaria') AND (peaks.elevation = (SELECT MAX(peaks.elevation) FROM peaks WHERE peaks.mountain_id = mountains_countries.mountain_id) OR peaks.peak_name IS NULL) ORDER BY mountains.mountain_range;
SELECT mountain_range AS name, 'mountain' AS type, (SELECT MAX(peaks.elevation) FROM peaks WHERE peaks.mountain_id = mountains.id LIMIT 1) AS info FROM mountains INNER JOIN mountains_countries ON mountains.id = mountains_countries.mountain_id WHERE mountains_countries.country_code = (SELECT countries.country_code FROM countries WHERE countries.country_name = 'Bulgaria') UNION SELECT river_name AS name, 'river' AS type, rivers.length AS info FROM rivers INNER JOIN countries_rivers ON rivers.id = countries_rivers.river_id WHERE countries_rivers.country_code = (SELECT countries.country_code FROM countries WHERE countries.country_name = 'Bulgaria') UNION SELECT peak_name AS name, 'peak' AS type, peaks.elevation AS info FROM peaks INNER JOIN mountains_countries ON peaks.mountain_id = mountains_countries.mountain_id WHERE mountains_countries.country_code = (SELECT countries.country_code FROM countries WHERE countries.country_name = 'Bulgaria') ORDER BY name;